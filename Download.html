<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    Do you want to download it now?</br></br>
    <form>
      <input type="button" value="OK" onclick="google.script.run.withSuccessHandler(executeDownload).SaveAndGetFileUrl();"/>
    </form>
  </body>
  <script>
    let sleep = ms => {  
      return new Promise(resolve => setTimeout(resolve, ms));  
    };  
    function executeDownload(url)
    {
      window.open(url);
      //window.location.href = url;
      sleep(500).then(() => {  
        google.script.host.close();
      });  
    }
    
  </script>

</html>
